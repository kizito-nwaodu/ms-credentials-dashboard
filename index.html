<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Microsoft Applied Skills Credentials Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f8f8; }
    h1 { color: #0078d7; }
    ul { list-style: none; padding: 0; }
    li { background: white; margin: 10px 0; padding: 15px; border-radius: 5px; box-shadow: 0 0 5px #ccc; }
    a { color: #0078d7; text-decoration: none; font-weight: bold; }
    a:hover { text-decoration: underline; }
    .desc { margin-top: 5px; font-size: 0.9em; color: #444; }
  </style>
</head>
<body>
  <h1>Microsoft Applied Skills Credentials</h1>
  <div id="status">Loading credentials...</div>
  <ul id="credentials-list"></ul>

  <script>
    async function fetchCredentials() {
      const statusEl = document.getElementById('status');
      const listEl = document.getElementById('credentials-list');

      try {
        const response = await fetch('https://learn.microsoft.com/api/catalog/?type=appliedSkills');
        const data = await response.json();

        const appliedSkills = data.value.filter(
          item => item.type === 'appliedSkill' || item.type === 'appliedSkills'
        );

        if (appliedSkills.length === 0) {
          statusEl.textContent = 'No applied skills credentials found.';
          return;
        }

        statusEl.textContent = '';
        appliedSkills.forEach(cred => {
          const li = document.createElement('li');
          const title = document.createElement('a');
          title.href = 'https://learn.microsoft.com' + cred.url;
          title.target = '_blank';
          title.textContent = cred.title;

          const desc = document.createElement('p');
          desc.className = 'desc';
          desc.textContent = cred.description || 'No description available.';

          li.appendChild(title);
          li.appendChild(desc);
          listEl.appendChild(li);
        });
      } catch (error) {
        statusEl.textContent = 'Failed to load credentials: ' + error.message;
      }
    }

    fetchCredentials();
  </script>
</body>
</html>
